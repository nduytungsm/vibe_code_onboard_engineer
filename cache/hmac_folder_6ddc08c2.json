{
  "content_hash": "ce092f36efcaa3fecbf7b153bf4ad614",
  "timestamp": "2025-09-26T11:55:00.794168+07:00",
  "result": {
    "path": "pkg/crypto/hmac",
    "purpose": "Responsible for HMAC (Hash-based Message Authentication Code) functionality, including signing, validation, and configuration.",
    "languages": {
      "Go": 6
    },
    "key_modules": [
      "config.go",
      "funcs.go",
      "funcs_test.go",
      "hmac.go",
      "hmac_test.go",
      "init.go"
    ],
    "dependencies": [
      "crypto/hmac",
      "crypto/sha256",
      "crypto/sha512",
      "encoding/base64",
      "errors",
      "fmt",
      "sort",
      "strings",
      "testing",
      "time",
      "math",
      "net/http",
      "sync"
    ],
    "architecture": "The folder follows a modular architecture pattern, encapsulating HMAC-related functionalities and tests within dedicated files, promoting separation of concerns.",
    "file_summaries": {
      "pkg/crypto/hmac/config.go": {
        "language": "Go",
        "purpose": "Defines a configuration structure for HMAC with normalization of whitelist addresses.",
        "key_types": [
          "Config"
        ],
        "functions": [
          "NormalizeWhitelistAddresses"
        ],
        "imports": [
          "strings"
        ],
        "side_effects": [
          "Modifies the WhitelistAddresses field of the Config struct."
        ],
        "complexity": "medium"
      },
      "pkg/crypto/hmac/funcs.go": {
        "language": "Go",
        "purpose": "Provides HMAC signing functions using SHA256 and SHA512 algorithms.",
        "key_types": [
          "[]byte",
          "map[string]string"
        ],
        "functions": [
          "SHA256",
          "SHA512",
          "Sign"
        ],
        "imports": [
          "crypto/hmac",
          "crypto/sha256",
          "crypto/sha512",
          "encoding/base64",
          "errors",
          "fmt",
          "sort",
          "strings"
        ],
        "side_effects": [
          "Modifies the order of parameters for signing",
          "Generates HMAC signatures"
        ],
        "risks": [
          "Potential for timing attacks if not implemented securely",
          "Improper handling of keys may lead to security vulnerabilities"
        ],
        "complexity": "medium"
      },
      "pkg/crypto/hmac/funcs_test.go": {
        "language": "Go",
        "purpose": "Unit tests for HMAC signing functionality",
        "key_types": [
          "struct",
          "map",
          "string",
          "byte"
        ],
        "functions": [
          "TestSign"
        ],
        "imports": [
          "testing",
          "time"
        ],
        "complexity": "medium"
      },
      "pkg/crypto/hmac/hmac.go": {
        "language": "Go",
        "purpose": "Provides HMAC validation functionality including signature verification and clock skew validation.",
        "key_types": [
          "HMAC",
          "Config"
        ],
        "functions": [
          "New",
          "validateClockSkew",
          "ValidateSignature"
        ],
        "imports": [
          "encoding/base64",
          "errors",
          "fmt",
          "math",
          "net/http",
          "sort",
          "time"
        ],
        "side_effects": [
          "Prints error messages to console if parsing time fails."
        ],
        "risks": [
          "Potential for time manipulation attacks if clock skew is not properly validated."
        ],
        "complexity": "medium"
      },
      "pkg/crypto/hmac/hmac_test.go": {
        "language": "Go",
        "purpose": "Unit tests for HMAC validation functions, checking clock skew and signature validation.",
        "key_types": [
          "Config",
          "HMAC"
        ],
        "functions": [
          "TestHMAC_validateClockSkew",
          "TestHMAC_ValidateSignature"
        ],
        "imports": [
          "testing",
          "time"
        ],
        "side_effects": [
          "None"
        ],
        "risks": [
          "Potential exposure of sensitive data if not handled properly"
        ],
        "complexity": "medium"
      },
      "pkg/crypto/hmac/init.go": {
        "language": "Go",
        "purpose": "This file initializes a singleton instance of the HMAC structure with a configuration.",
        "key_types": [
          "HMAC",
          "Config"
        ],
        "functions": [
          "init",
          "InitInstance"
        ],
        "imports": [
          "sync"
        ],
        "side_effects": [
          "Initializes a global instance of HMAC if not already initialized."
        ],
        "risks": [
          "Potential race conditions if InitInstance is called concurrently without proper synchronization."
        ],
        "complexity": "medium"
      }
    }
  }
}